<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TRANSPERSO — Personalized Route Planning</title>
  {% load static %}
  {% load dict_filters %}
    <link rel="stylesheet" href="{% static 'core/style.css' %}">
    <style>
    /* ====== PALETTE TRANSPERSO (basée sur l'image) ====== */
    :root{
      /* Fond et ciel */
      --beige-light:#FFE8D6;      /* beige clair du ciel */
      --beige-dark:#FFD7BA;       /* beige foncé vers l'horizon */
      --brown-hills:#B89A7E;      /* brun des collines */
      
      /* Route */
      --road-gray:#666666;        /* gris de la route */
      --road-lines:#FFFFFF;        /* blanc des lignes */
      
      /* Véhicules */
      --red-firetruck:#E74C3C;    /* rouge camion de pompiers */
      --blue-van:#3498DB;          /* bleu van */
      --yellow-bus:#F1C40F;        /* jaune bus scolaire */
      --orange-details:#F39C12;    /* orange détails */
      
      /* Interface */
      --white:#FFFFFF;
      --black:#000000;
      --green:#00B980;             /* vert TRANSPERSO */
      --green-dark:#00976B;
      --green-light:#E6F7F0;
      
      /* Texte */
      --text-dark:#2C3E50;
      --text-muted:#7F8C8D;
      
      /* Ombres et bordures */
      --stroke:#E2E8F0;
      --shadow-sm:0 2px 8px rgba(0,0,0,.1);
      --shadow-md:0 8px 24px rgba(0,0,0,.15);
      --shadow-lg:0 16px 48px rgba(0,0,0,.2);
      --radius:12px;
      --transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    *{ margin:0; padding:0; box-sizing:border-box; }

    html, body{
      width:100%;
      overflow-x:hidden;
    }

    body{
      font-family:"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background:linear-gradient(180deg, var(--beige-light) 0%, var(--beige-dark) 100%);
      color:var(--text-dark);
      line-height:1.6;
      min-height:100vh;
      position:relative;
      margin:0;
      padding:0;
      background-image:url('{% static "core/img/buses.png" %}');
      background-size:cover;
      background-position:center;
      background-attachment:fixed;
      background-repeat:no-repeat;
    }
    body::before{
      content:'';
      position:fixed;
      top:0;
      left:0;
      right:0;
      bottom:0;
      background:linear-gradient(180deg, rgba(255,232,214,0.6) 0%, rgba(255,215,186,0.6) 100%);
      z-index:0;
      pointer-events:none;
    }

    /* ====== HEADER ====== */
    header{
      background:rgba(255,255,255,0.98);
      backdrop-filter:blur(20px) saturate(180%);
      border-bottom:2px solid rgba(0,185,128,0.2);
      padding:20px 0;
      position:sticky;
      top:0;
      left:0;
      right:0;
      width:100%;
      z-index:100;
      box-shadow:0 2px 20px rgba(0,0,0,0.08);
      margin:0;
    }
    .header-content{
      max-width:1400px;
      margin:0 auto;
      padding:0 60px;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }
    .logo-section{
      display:flex;
      align-items:center;
      gap:12px;
    }
    .logo-icon{
      width:48px;
      height:48px;
      background:var(--black);
      border-radius:10px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--white);
      font-weight:900;
      font-size:24px;
      box-shadow:var(--shadow-sm);
    }
    .logo-text{
      display:flex;
      flex-direction:column;
    }
    .logo-text h1{
      font-size:28px;
      font-weight:900;
      color:var(--black);
      letter-spacing:-0.5px;
      margin:0;
      line-height:1.2;
    }
    .logo-text h1 .trans{
      color:var(--black);
      position:relative;
    }
    .logo-text h1 .trans::after{
      content:'';
      position:absolute;
      bottom:2px;
      left:0;
      right:0;
      height:3px;
      background:var(--black);
      border-radius:2px;
    }
    .logo-text h1 .perso{
      color:var(--green);
      position:relative;
    }
    .logo-text h1 .perso::after{
      content:'';
      position:absolute;
      bottom:2px;
      left:0;
      right:0;
      height:3px;
      background:var(--green);
      border-radius:2px;
    }
    .logo-text .tagline{
      font-size:12px;
      color:var(--text-muted);
      font-weight:600;
      margin-top:4px;
      letter-spacing:1px;
      text-transform:uppercase;
    }
    .header-nav{
      display:flex;
      align-items:center;
    }
    .nav-links{
      display:flex;
      gap:40px;
      list-style:none;
    }
    .nav-links a{
      text-decoration:none;
      color:var(--text-dark);
      font-weight:600;
      font-size:15px;
      transition:var(--transition);
      position:relative;
      padding:8px 0;
    }
    .nav-links a::after{
      content:'';
      position:absolute;
      bottom:0;
      left:0;
      width:0;
      height:2px;
      background:var(--green);
      transition:var(--transition);
    }
    .nav-links a:hover{
      color:var(--green);
    }
    .nav-links a:hover::after{
      width:100%;
    }

    /* ====== HERO SECTION ====== */
    .hero{
      max-width:1400px;
      margin:120px auto 150px;
      padding:0 60px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      text-align:center;
      position:relative;
      z-index:1;
    }
    .hero-content{
      max-width:1000px;
      position:relative;
      z-index:2;
    }
    .hero-content h2{
      font-size:68px;
      font-weight:900;
      line-height:1.2;
      margin-bottom:28px;
      letter-spacing:-2px;
      text-align:center;
    }
    .hero-content h2 .trans{
      color:var(--black);
      position:relative;
      text-shadow:3px 3px 12px rgba(255,255,255,0.95), 0 0 25px rgba(255,255,255,0.8), 0 0 40px rgba(255,255,255,0.5);
    }
    .hero-content h2 .trans::after{
      content:'';
      position:absolute;
      bottom:4px;
      left:0;
      right:0;
      height:4px;
      background:var(--black);
      opacity:0.6;
      border-radius:2px;
    }
    .hero-content h2 .perso{
      color:var(--green);
      position:relative;
      text-shadow:3px 3px 12px rgba(255,255,255,0.95), 0 0 25px rgba(255,255,255,0.8), 0 0 40px rgba(255,255,255,0.5);
    }
    .hero-content h2 .perso::after{
      content:'';
      position:absolute;
      bottom:4px;
      left:0;
      right:0;
      height:4px;
      background:var(--green);
      opacity:0.6;
      border-radius:2px;
      box-shadow:0 0 10px rgba(0,185,128,0.4);
    }
    .hero-content p{
      font-size:22px;
      color:var(--black);
      margin-bottom:40px;
      line-height:1.7;
      max-width:850px;
      font-weight:600;
      text-align:center;
      margin-left:auto;
      margin-right:auto;
      text-shadow:2px 2px 10px rgba(255,255,255,0.95), 0 0 20px rgba(255,255,255,0.7), 0 0 30px rgba(255,255,255,0.5);
    }
    .cta-hero{
      background:var(--black);
      color:var(--white);
      padding:20px 50px;
      border-radius:var(--radius);
      text-decoration:none;
      font-weight:700;
      font-size:18px;
      display:inline-block;
      transition:var(--transition);
      border:2px solid var(--black);
      box-shadow:var(--shadow-lg);
      margin:0 auto;
    }
    .cta-hero:hover{
      background:var(--green);
      border-color:var(--green);
      transform:translateY(-3px);
      box-shadow:0 12px 40px rgba(0,185,128,0.4);
    }
    .hero-image{
      display:none;
    }

    /* ====== FEATURES SECTION ====== */
    .features{
      max-width:1400px;
      margin:120px auto;
      padding:0 60px;
      position:relative;
      z-index:1;
      background:rgba(255,255,255,0.8);
      backdrop-filter:blur(10px);
      padding:60px;
      border-radius:24px;
      margin-top:200px;
    }
    .features-title{
      text-align:center;
      font-size:48px;
      font-weight:900;
      color:var(--black);
      margin-bottom:60px;
      letter-spacing:-1px;
    }
    .features-grid{
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:40px;
    }
    .feature-card{
      background:var(--white);
      padding:50px 40px;
      border-radius:20px;
      border:2px solid var(--stroke);
      text-align:center;
      transition:var(--transition);
      box-shadow:var(--shadow-sm);
    }
    .feature-card:hover{
      transform:translateY(-10px);
      box-shadow:var(--shadow-lg);
      border-color:var(--green);
    }
    .feature-icon{
      width:80px;
      height:80px;
      background:var(--black);
      border-radius:16px;
      display:flex;
      align-items:center;
      justify-content:center;
      margin:0 auto 28px;
      color:var(--white);
      font-size:36px;
      box-shadow:var(--shadow-md);
    }
    .feature-card h3{
      font-size:24px;
      font-weight:800;
      color:var(--black);
      margin-bottom:16px;
      letter-spacing:-0.5px;
    }
    .feature-card p{
      color:var(--text-muted);
      font-size:16px;
      line-height:1.7;
    }

    /* ====== QUERY SECTION ====== */
    .query-section{
      max-width:1100px;
      margin:120px auto;
      padding:70px 60px;
      background:rgba(255,255,255,0.95);
      backdrop-filter:blur(20px) saturate(180%);
      border-radius:24px;
      border:2px solid rgba(255,255,255,0.5);
      box-shadow:var(--shadow-lg);
      position:relative;
      z-index:1;
    }
    .query-section::before{
      content:'';
      position:absolute;
      top:0;
      left:0;
      width:100%;
      height:5px;
      background:linear-gradient(90deg, var(--green), var(--green-dark));
      border-radius:24px 24px 0 0;
    }
    .query-section h2{
      font-size:42px;
      font-weight:900;
      color:var(--black);
      margin-bottom:16px;
      text-align:center;
      letter-spacing:-1px;
    }
    .query-section > p{
      text-align:center;
      color:var(--text-muted);
      margin-bottom:40px;
      font-size:18px;
    }
    .query-section > p em{
      color:var(--green);
      font-style:normal;
      font-weight:700;
      background:var(--green-light);
      padding:4px 12px;
      border-radius:8px;
      font-size:17px;
    }
    form{
      display:flex;
      gap:14px;
      margin-bottom:24px;
      flex-wrap:wrap;
    }
    input[type="text"]{
      flex:1;
      min-width:320px;
      padding:16px 20px;
      border:2px solid var(--stroke);
      border-radius:var(--radius);
      background:var(--white);
      outline:none;
      font-size:16px;
      font-family:inherit;
      transition:var(--transition);
      box-shadow:var(--shadow-sm);
    }
    input[type="text"]::placeholder{
      color:var(--text-muted);
      opacity:0.6;
    }
    input[type="text"]:focus{
      border-color:var(--green);
      box-shadow:0 0 0 5px var(--green-light), var(--shadow-md);
    }
    button[type="submit"]{
      background:var(--green);
      color:var(--white);
      border:0;
      border-radius:var(--radius);
      padding:16px 32px;
      font-weight:700;
      font-size:16px;
      cursor:pointer;
      transition:var(--transition);
      box-shadow:0 4px 12px rgba(0,185,128,0.3);
      font-family:inherit;
    }
    button[type="submit"]:hover{
      background:var(--green-dark);
      transform:translateY(-3px);
      box-shadow:0 6px 20px rgba(0,185,128,0.4);
    }
    .ghost{
      background:transparent;
      color:var(--text-dark);
      border:2px dashed var(--stroke);
      box-shadow:none;
      margin-top:20px;
      padding:14px 28px;
    }
    .ghost:hover{
      background:var(--beige-light);
      border-color:var(--green);
      color:var(--green);
      transform:translateY(-2px);
    }
    .info, .error{
      margin-top:20px;
      padding:16px 20px;
      border-radius:var(--radius);
      font-size:15px;
      font-weight:500;
    }
    .info{
      color:var(--green);
      background:var(--green-light);
      border-left:4px solid var(--green);
    }
    .error{
      color:#E74C3C;
      background:#FEF2F2;
      border-left:4px solid #E74C3C;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-top:32px;
      background:var(--white);
      border-radius:var(--radius);
      overflow:hidden;
      box-shadow:var(--shadow-sm);
      border:1px solid var(--stroke);
    }
    thead{
      background:linear-gradient(135deg, var(--green-light), #F0FDF9);
    }
    th{
      padding:18px;
      text-align:left;
      font-weight:700;
      color:var(--black);
      font-size:14px;
      text-transform:uppercase;
      letter-spacing:0.5px;
      border-bottom:2px solid var(--stroke);
    }
    td{
      padding:16px 18px;
      border-bottom:1px solid var(--stroke);
      color:var(--text-dark);
      font-size:15px;
    }
    tbody tr{
      transition:var(--transition);
    }
    tbody tr:hover{
      background:#FAFAFA;
    }
    tbody tr:last-child td{
      border-bottom:none;
    }


    /* ====== FOOTER ====== */
    footer{
      text-align:center;
      color:var(--text-muted);
      padding:50px 0;
      border-top:1px solid var(--stroke);
      font-size:15px;
      margin-top:120px;
      background:rgba(255,255,255,0.5);
    }

    /* ====== HILLS DECORATION ====== */
    .hills-decoration{
      position:fixed;
      bottom:0;
      left:0;
      right:0;
      height:200px;
      background:var(--brown-hills);
      clip-path:polygon(0 100%, 0 80%, 15% 70%, 30% 75%, 45% 65%, 60% 70%, 75% 60%, 90% 65%, 100% 55%, 100% 100%);
      opacity:0.4;
      z-index:0;
      pointer-events:none;
    }

    /* ====== RESPONSIVE ====== */
    @media(max-width:1024px){
      .hero{ grid-template-columns:1fr; gap:60px; }
      .hero-image{ order:-1; }
      .hero-content h2{ font-size:48px; }
      .features-grid{ grid-template-columns:repeat(2, 1fr); }
      .features-title{ font-size:40px; }
    }
    @media(max-width:768px){
      header{ padding:16px 24px; }
      .header-content{ flex-wrap:wrap; gap:16px; }
      .header-nav{ width:100%; justify-content:center; }
      .nav-links{ gap:24px; flex-wrap:wrap; }
      .hero{ padding:0 24px; margin:60px auto 80px; }
      .hero-content h2{ font-size:36px; }
      .hero-content p{ font-size:18px; }
      .features{ padding:0 24px; margin:80px auto; }
      .features-grid{ grid-template-columns:1fr; gap:32px; }
      .features-title{ font-size:36px; margin-bottom:40px; }
      .query-section{ padding:50px 30px; margin:80px 20px; }
      .query-section h2{ font-size:32px; }
      form{ flex-direction:column; }
      input[type="text"], button{ width:100%; }
    }
    @media(max-width:480px){
      .logo-text h1{ font-size:22px; }
      .hero-content h2{ font-size:28px; }
      .query-section{ padding:40px 24px; }
      .query-section h2{ font-size:28px; }
    }
    </style>
</head>
<body>
  <!-- HILLS DECORATION -->
  <div class="hills-decoration"></div>

  <!-- HEADER -->
  <header>
    <div class="header-content">
      <div class="logo-section">
        <div class="logo-icon">T</div>
        <div class="logo-text">
          <h1><span class="trans">TRANS</span><span class="perso">PERSO</span></h1>
          <p class="tagline">Personalized Route Planning System</p>
        </div>
      </div>
      <nav class="header-nav">
        <ul class="nav-links">
          <li><a href="#">Home</a></li>
          <li><a href="#features">Features</a></li>
          <li><a href="#query">Queries</a></li>
          <li><a href="#">About</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- HERO SECTION -->
  <section class="hero">
    <div class="hero-content">
      <h2><span class="trans">TRANS</span><span class="perso">PERSO</span></h2>
      <p>TRANSPERSO connects passengers, tickets, and transport networks through semantic web intelligence. Get personalized route recommendations tailored to your preferences.</p>
      <a href="#query" class="cta-hero">Try a Query</a>
    </div>
  </section>

  <!-- FEATURES SECTION -->
  <section id="features" class="features">
    <h2 class="features-title">Key Features</h2>
    <div class="features-grid">
      <div class="feature-card">
        <div class="feature-icon">⚡</div>
        <h3>Rapidité et sécurité</h3>
        <p>Get instant semantic queries with reliable transport data from our ontology.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">🔄</div>
        <h3>Flexibilité et évolutivité</h3>
        <p>Scalable system that adapts to various transport modes and city networks.</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon">🤝</div>
        <h3>Meilleure collaboration</h3>
        <p>Connect passengers, companies, and transport systems seamlessly.</p>
      </div>
    </div>
  </section>

  <!-- QUERY SECTION -->
  <section id="query" class="query-section">
    <h2>Ask a Semantic Question</h2>
    <p>Example: <em>"Show bus lines in Tunis"</em></p>

        <form method="post" action="{% url 'query' %}">
            {% csrf_token %}
            <input type="text" name="question" placeholder="Your question..." required>
            <button type="submit">Ask</button>
        </form>

    <button class="ghost" onclick="loadOntology()">⚙️ Load Ontology into Fuseki</button>
        <p id="load-status"></p>

    {% if processed_results %}
      <table>
        <thead>
          <tr>
            {% for var in vars %}<th>{{ var }}</th>{% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in processed_results %}
            <tr>
              {% for var in vars %}
                <td>{{ row|get_item:var }}</td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endif %}

        {% if error %}
            <p class="error">{{ error }}</p>
        {% endif %}
  </section>

  <!-- FOOTER -->
  <footer>
    © 2025 TRANSPERSO — Team SHECODES | Oumaima Amdouni et al.
  </footer>

    <script>
    function loadOntology(){
      const statusEl = document.getElementById('load-status');
      statusEl.textContent = '⏳ Loading ontology...';
      statusEl.className = 'info';
      
        fetch("{% url 'load_ontology' %}")
        .then(r=>r.json())
        .then(d=>{
          if(d.status === 'success'){
            statusEl.textContent = '✅ ' + (d.message || 'Success');
            statusEl.className = 'info';
          } else {
            statusEl.textContent = '❌ ' + (d.message || d.error || 'Error');
            statusEl.className = 'error';
          }
        })
        .catch(()=>{
          statusEl.textContent = '❌ Network error. Please try again.';
          statusEl.className = 'error';
            });
    }
    </script>
</body>
</html>
